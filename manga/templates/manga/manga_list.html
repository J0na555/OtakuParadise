{% extends "base.html" %}
{% load static %}
{% block title %} Manga - Otaku Paradise {% endblock %}

{% block content %}
    <h1>Manga list</h1>

    <form action="" method="get">
        <input type="text"name="q" placeholder="Search manga" value="{{query}}" >
        <input type="number"name="year" placeholder="Year" value="{{year}}" >
        <input type="number"name="min_score" placeholder="Min score" value="{{min_score}}" >

        <h3>Genres</h3>
        {% for genre in all_genres %}
            <label >
                <input type="checkbox" name="genres" value="{{ genre.mal_id }}" 
                    {% if genre.mal_id|stringformat:"s" in selected_genres %}checked{% endif %}>
                {{ genre.name }}
            </label><br>
        {% endfor %}
        <button type="submit">Filter</button>
    </form>
    

    <ul>
        {% for manga in mangas %}
            <li> {{ manga.title }}</li>
            <img src="{{ manga.images.jpg.image_url}}" alt="{{ manga.title}}" width="250">
        {% empty %}
            <li>No manga found</li>
        {% endfor %}
    </ul>
    <div class="pagination-container">
        {% if pagination.has_previous_page %}
            <a class="pagination-btn" href="?q={{ query }}{% for g in selected_genres %}&genres={{ g }}{% endfor %}&year={{ year }}&min_score={{ min_score }}&page={{ current_page|add:"-1" }}">
                <i class="fas fa-chevron-left me-1"></i> Previous
            </a>
        {% else %}
            <span class="pagination-btn disabled">
                <i class="fas fa-chevron-left me-1"></i> Previous
            </span>
        {% endif %}

        <div class="pagination-info">
            page <span>{{ current_page }}</span>
        </div>

        {% if pagination.has_next_page %}
            <a href="?q={{ query }}{% for g in selected_genres %}&genres={{ g }}{% endfor %}&year={{ year }}&min_score={{ min_score }}&page={{ current_page|add:"1" }}">
                Next <i class="fas fa-chevron-right ms-1"></i>
            </a>
        {% else %}
            <span class="pagination-btn disabled">
                Next <i class="fas fa-chevron-right ms-1"></i>
            </span>
        {% endif %}
    </div>
{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'manga/css/manga.css' %}">
{% endblock %}